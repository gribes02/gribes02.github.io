<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Malware Classification | Guillem Ribes Espurz</title> <meta name="author" content="Guillem Ribes Espurz"> <meta name="description" content="Using a CNN to classify MalwareImages"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://gribes02.github.io/projects/4_project/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?e74e74bf055e5729d44a7d031a5ca6a5" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?96d6b3e1c3604aca8b6134c7afdd5db6"></script> <script src="/assets/js/dark_mode.js?9b17307bb950ffa2e34be0227f53558f"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Guillem </span>Ribes Espurz</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Malware Classification</h1> <p class="post-description">Using a CNN to classify MalwareImages</p> </header> <article> <div class="repo p-2 text-center"> <a href="https://github.com/" rel="external nofollow noopener" target="_blank"> <img class="repo-img-light w-100" alt="" src="https://github-readme-stats.vercel.app/api/pin/?username=&amp;repo=&amp;theme=default&amp;show_owner=true"> <img class="repo-img-dark w-100" alt="" src="https://github-readme-stats.vercel.app/api/pin/?username=&amp;repo=&amp;theme=dark&amp;show_owner=true"> </a> </div> <h1 id="deep-learning-project---reproduction-study">Deep Learning Project - Reproduction Study</h1> <p>In this assignment, we reproduced the CNN presented in “Using convolutional neural networks for classification of malware represented as images”* [1]. This CNN was then tested using 10-fold cross validation to determine whether we would achieve similar performance to the paper. Furthermore, we implemented nested cross validation to perform further hyperparameter tuning on the CNN. The best model architecture that was found was then trained and tested on a much larger dataset (~147GB) of malware images.</p> <p><img src="assets/img/malware.png" alt="Malware"></p> <h3 id="hyperparameter-tuning">Hyperparameter Tuning</h3> <p>Nested cross-validation was used in grid search to mitigate overfitting and yield a more dependable assessment of model performance. Regular cross-validation may lead to higher estimates of model performance because the model evaluation is done on seen data. Nested cross-validation performs an outer loop of cross-validation for model evaluation and an inner loop of cross-validation for hyperparameter tuning, ensuring that the model’s performance is evaluated on unseen data during hyperparameter tuning. This helps to provide a more realistic estimation of the model’s performance.</p> <table> <thead> <tr> <th>Number of Convolutional Layers</th> <th>Number of Feed Forward Layers</th> <th>Number of Output Nodes</th> <th>FeedForward Layer Output Sizes</th> <th>Kernel Size for Convolution Layer</th> </tr> </thead> <tbody> <tr> <td>2</td> <td>[1, 2]</td> <td>[40, 50], [70, 90]</td> <td>[25], [50, 25]</td> <td>[5, 3], [9, 5]</td> </tr> <tr> <td>3</td> <td>[1, 2]</td> <td>[25, 50, 50], [50, 70, 70], [70, 90, 90]</td> <td>[25], [50, 25]</td> <td>[5, 3, 3], [9, 5, 5]</td> </tr> <tr> <td>4</td> <td>[1, 2]</td> <td>[20, 30, 40, 50], [50, 70, 70, 90]</td> <td>[25], [50, 25]</td> <td>[5, 3, 3, 3], [9, 5, 5, 3]</td> </tr> </tbody> </table> <h3 id="running-the-code">Running the code</h3> <p>After cloning the respository, you should have the following files:</p> <ul> <li> <code class="language-plaintext highlighter-rouge">CNN.py</code> This file contains the CNN class. You should not have to change anything in this file.</li> <li> <code class="language-plaintext highlighter-rouge">nested_cross_validation.py</code> This file contains the logic for the nested cross validation. You should not have to change anything in this file.</li> <li> <code class="language-plaintext highlighter-rouge">cross_validation.py</code> This file contains the logic for the cross validation. You should not have to change anything in this file.</li> <li> <code class="language-plaintext highlighter-rouge">parameters.py</code> This file contains the parameters and transforms for the models that were used to get the results. You should not have to change anything in this file.</li> <li> <code class="language-plaintext highlighter-rouge">config.py</code> This file contains some paths to the datasets and in this file you also set some parameters that are used by <code class="language-plaintext highlighter-rouge">nested_crosss_validation.py</code> and <code class="language-plaintext highlighter-rouge">cross_validation.py</code>. You will have to change this file.</li> </ul> <h4 id="changes-that-you-need-to-make-in-configpy">Changes that you need to make in <code class="language-plaintext highlighter-rouge">config.py</code> </h4> <p><code class="language-plaintext highlighter-rouge">MALIMG_DATASET_PATH</code> and <code class="language-plaintext highlighter-rouge">AKASH_DATASET_PATH</code> store the paths to the MalImg dataset and Akash’s dataset, respectively. Hence, you need to set these paths correctly, such that the datsets can be accessed by the code.</p> <p><code class="language-plaintext highlighter-rouge">CV_DATASET_PATH</code> specifies the path to the dataset that you want to run. <code class="language-plaintext highlighter-rouge">CV_DATASET_PATH</code> should be set equal to either <code class="language-plaintext highlighter-rouge">MALIMG_DATASET_PATH</code> or <code class="language-plaintext highlighter-rouge">AKASH_DATASET_PATH</code>. Later will be explained how this variable should be assigned.</p> <p><code class="language-plaintext highlighter-rouge">CV_PARAMS</code> specifies the model that you want to run. <code class="language-plaintext highlighter-rouge">CV_PARAMS</code> should be set equal to either <code class="language-plaintext highlighter-rouge">base_model_malimg</code>, <code class="language-plaintext highlighter-rouge">best_model_malimg</code>, or <code class="language-plaintext highlighter-rouge">best_model_dataAkash</code>. Note that if you selected the MalImg dataset in <code class="language-plaintext highlighter-rouge">CV_DATASET_PATH</code>, you can only use the models <code class="language-plaintext highlighter-rouge">base_model_malimg</code> and <code class="language-plaintext highlighter-rouge">best_model_malimg</code>. Similarly, if you specified Akash’s dataset to be used, you can only use the model <code class="language-plaintext highlighter-rouge">best_model_dataAkash</code>. These model parameters are stored inside <code class="language-plaintext highlighter-rouge">parameters.py</code>. <code class="language-plaintext highlighter-rouge">base_model_malimg</code> contains the parameters of the CNN from the paper. <code class="language-plaintext highlighter-rouge">best_model_malimg</code> contains the parameters of the best CNN that we found in the nested_cross validation. <code class="language-plaintext highlighter-rouge">best_model_dataAkash</code> contains the parameters of the best CNN that we found in the nested_cross validation, but this model is meant to be run only by <code class="language-plaintext highlighter-rouge">cross_validation.py</code> on Akash’s dataset.</p> <p>The variables below specify the paths to store the models that are stored and loaded in <code class="language-plaintext highlighter-rouge">nested_cross_validation.py</code>. Please set these paths appropriately.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>INNER_MODEL_PARAMS_PATH = 'inner_model_params.pt'
INNER_MODEL_PATH        = 'working/best_inner_model.pt'
OUTER_MODEL_PATH        = 'best_outer_model.pt'
OUTER_MODEL_PARAMS_PATH = 'outer_model_params.pt'
LOG_FILE                = 'log_file.txt'
</code></pre></div></div> <h4 id="our-runs">Our runs</h4> <p>To get the results that are shown in the <strong>Results</strong> section, the following runs were executed:</p> <ol> <li><em>Cross validation on <code class="language-plaintext highlighter-rouge">base_model_malimg</code> on the MalImg dataset</em></li> </ol> <p>To reproduce the results of the paper, we ran <code class="language-plaintext highlighter-rouge">cross_validation.py</code> on the MalImg dataset with the <code class="language-plaintext highlighter-rouge">baste_model_malimg</code> parameters. To replicate this run, set the following parameters in the <code class="language-plaintext highlighter-rouge">config.py</code> file as follows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CV_DATASET_PATH = MALIMG_DATASET_PATH
CV_PARAMS = base_model_malimg
</code></pre></div></div> <p>All other parameters are already set to the same parameters that were used to run it by use. However, if you need to change the batch size, you can change <code class="language-plaintext highlighter-rouge">batch_size</code> inside <code class="language-plaintext highlighter-rouge">cross_validation.py</code>. Once the <code class="language-plaintext highlighter-rouge">config.py</code> file is set correctly, you simply need to run <code class="language-plaintext highlighter-rouge">cross_validation.py</code>.</p> <ol> <li><em>Nested cross validation on the MalImg dataset</em></li> </ol> <p>Next, we performed hyperparameter tuning to try and find a better model on the MalImg dataset. You can replicate this run by simply running <code class="language-plaintext highlighter-rouge">nested_cross_validation.py</code>. This will automatically run the grid search with the parameter grid stored inside <code class="language-plaintext highlighter-rouge">parameters.py</code> on the MalImg dataset, with the same batch size, number of epochs, number of inner folds, and number outer folds that we ran it at. You can change the batch size by changing the variable <code class="language-plaintext highlighter-rouge">BATCH_SIZE</code> inside <code class="language-plaintext highlighter-rouge">nested_cross_validation.py</code>. Note that <code class="language-plaintext highlighter-rouge">CV_DATASET_PATH</code> and <code class="language-plaintext highlighter-rouge">CV_PARAMS</code> are not used by <code class="language-plaintext highlighter-rouge">nested_cross_validation.py</code>, since this code should only be run on the MalImg dataset. Hence, you do not need to change any variables inside <code class="language-plaintext highlighter-rouge">config.py</code> for this run.</p> <ol> <li><em>Cross validation with best model on MalImg</em></li> </ol> <p>The parameters of the best model resulting from the nested cross validation is stored in <code class="language-plaintext highlighter-rouge">best_model_malimg</code>. Hence, to replicate this run, set the variables in <code class="language-plaintext highlighter-rouge">config.py</code> as follows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CV_DATASET_PATH = MALIMG_DATASET_PATH
CV_PARAMS = best_model_malimg
</code></pre></div></div> <p>And then run <code class="language-plaintext highlighter-rouge">cross_validation.py</code>.</p> <ol> <li><em>Cross validation with best model on Akash’s dataset</em></li> </ol> <p>Finally, the best model resulting from the hyperparameter tuning was trained and tested on Akash’s dataset. To replicate this run, set the <code class="language-plaintext highlighter-rouge">config.py</code> file as follows:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CV_DATASET_PATH = AKASH_DATASET_PATH 
CV_PARAMS = best_model_dataAkash
</code></pre></div></div> <p>and run the <code class="language-plaintext highlighter-rouge">cross_validation.py</code> file.</p> <h2 id="results">Results</h2> <h3 id="grid-search-on-malimg-dataset">Grid Search on Malimg Dataset</h3> <p>From the grid search a few observations were made. Below are the best models found during the nested cross validation. As can be seen in the table, the architecture with 3 convolutional layers performed the best. However, the architecture with only 2 convolutional layers was not far off in terms of test accuracy which was intriguing to see. Another thing that was noted is how adding 2 feed forward layers greatly decreased the performance of the model.</p> <p><strong>Best Parameters</strong></p> <table> <thead> <tr> <th>Convolutional Layers</th> <th>Feed Forward Layers</th> <th>Output Nodes</th> <th>Output Sizes</th> <th>Kernel Size</th> </tr> </thead> <tbody> <tr> <td>4</td> <td>1</td> <td>[50, 70, 70, 90]</td> <td>[25]</td> <td>[5, 3, 3, 3]</td> </tr> <tr> <td>3</td> <td>1</td> <td>[70, 90, 90]</td> <td>[25]</td> <td>[5, 3, 3]</td> </tr> <tr> <td>2</td> <td>1</td> <td>[40, 50]</td> <td>[25]</td> <td>[5, 3]</td> </tr> </tbody> </table> <p><strong>Accuracy, MAE and Std. Dev for Convolutional Layers</strong></p> <table> <thead> <tr> <th>Number of Convolutional Layers</th> <th>Test Accuracy</th> <th>Test MAE</th> <th>Std. Dev. Accuracy</th> <th>Std. Dev. MAE</th> </tr> </thead> <tbody> <tr> <td>4</td> <td>97.27%</td> <td>0.30</td> <td>0.151</td> <td>0.017</td> </tr> <tr> <td>3</td> <td>98.62%</td> <td>0.07</td> <td>0.149</td> <td>0.004</td> </tr> <tr> <td>2</td> <td>98.52%</td> <td>0.07</td> <td>0.084</td> <td>0.009</td> </tr> </tbody> </table> <p>Hence, the best model resulting from the hyperparameter tuning with nested cross validation was the CNN with 3 convolutional layers, output channels <code class="language-plaintext highlighter-rouge">[70,90,90]</code>, kernel sizes <code class="language-plaintext highlighter-rouge">[5,3,3]</code>, and a single feedforward layer. Once we had the best model it was ran on the Malimg dataset in order to compare the architecture that the paper proposes against the architecture that was found through grid search.</p> <h3 id="papers-model-results">Paper’s Model Results</h3> <table> <thead> <tr> <th> </th> <th style="text-align: center">Precision</th> <th style="text-align: center">Recall</th> <th style="text-align: center">F1 Score</th> </tr> </thead> <tbody> <tr> <td>0</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>1</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>2</td> <td style="text-align: center">0.999322</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.999661</td> </tr> <tr> <td>3</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>4</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.994949</td> <td style="text-align: center">0.997468</td> </tr> <tr> <td>5</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.584906</td> <td style="text-align: center">0.738095</td> </tr> <tr> <td>6</td> <td style="text-align: center">0.936620</td> <td style="text-align: center">0.910959</td> <td style="text-align: center">0.923611</td> </tr> <tr> <td>7</td> <td style="text-align: center">0.960784</td> <td style="text-align: center">0.980000</td> <td style="text-align: center">0.970297</td> </tr> <tr> <td>8</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>9</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>10</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.997375</td> <td style="text-align: center">0.998686</td> </tr> <tr> <td>11</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>12</td> <td style="text-align: center">0.972603</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.986111</td> </tr> <tr> <td>13</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.978261</td> <td style="text-align: center">0.989011</td> </tr> <tr> <td>14</td> <td style="text-align: center">0.991736</td> <td style="text-align: center">0.975610</td> <td style="text-align: center">0.983607</td> </tr> <tr> <td>15</td> <td style="text-align: center">0.993671</td> <td style="text-align: center">0.987421</td> <td style="text-align: center">0.990536</td> </tr> <tr> <td>16</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.985294</td> <td style="text-align: center">0.992593</td> </tr> <tr> <td>17</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>18</td> <td style="text-align: center">0.993671</td> <td style="text-align: center">0.993671</td> <td style="text-align: center">0.993671</td> </tr> <tr> <td>19</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>20</td> <td style="text-align: center">0.800000</td> <td style="text-align: center">0.812500</td> <td style="text-align: center">0.806202</td> </tr> <tr> <td>21</td> <td style="text-align: center">0.765152</td> <td style="text-align: center">0.765152</td> <td style="text-align: center">0.765152</td> </tr> <tr> <td>22</td> <td style="text-align: center">0.995086</td> <td style="text-align: center">0.992647</td> <td style="text-align: center">0.993865</td> </tr> <tr> <td>23</td> <td style="text-align: center">0.979798</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.989796</td> </tr> <tr> <td>24</td> <td style="text-align: center">0.947867</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.973236</td> </tr> </tbody> </table> <p><img src="assets/img/ConfusionMatrixBaseModel.png" alt="Confusion Matrix Base Image"></p> <h3 id="best-model-found-from-grid-search">Best Model Found From Grid Search</h3> <p><img src="assets/img/ConfusionMatrixBestModel.png" alt="Confusion Matrix Best Image"></p> <table> <thead> <tr> <th> </th> <th style="text-align: center">Precision</th> <th style="text-align: center">Recall</th> <th style="text-align: center">F1 Score</th> </tr> </thead> <tbody> <tr> <td>0</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>1</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>2</td> <td style="text-align: center">0.999661</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.999830</td> </tr> <tr> <td>3</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>4</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.994949</td> <td style="text-align: center">0.997468</td> </tr> <tr> <td>5</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.443396</td> <td style="text-align: center">0.614379</td> </tr> <tr> <td>6</td> <td style="text-align: center">0.892617</td> <td style="text-align: center">0.910959</td> <td style="text-align: center">0.901695</td> </tr> <tr> <td>7</td> <td style="text-align: center">0.960976</td> <td style="text-align: center">0.985000</td> <td style="text-align: center">0.972840</td> </tr> <tr> <td>8</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>9</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>10</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.992126</td> <td style="text-align: center">0.996047</td> </tr> <tr> <td>11</td> <td style="text-align: center">0.997680</td> <td style="text-align: center">0.997680</td> <td style="text-align: center">0.997680</td> </tr> <tr> <td>12</td> <td style="text-align: center">0.981567</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.990698</td> </tr> <tr> <td>13</td> <td style="text-align: center">0.994505</td> <td style="text-align: center">0.983696</td> <td style="text-align: center">0.989071</td> </tr> <tr> <td>14</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.983740</td> <td style="text-align: center">0.991803</td> </tr> <tr> <td>15</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.987421</td> <td style="text-align: center">0.993671</td> </tr> <tr> <td>16</td> <td style="text-align: center">0.992593</td> <td style="text-align: center">0.985294</td> <td style="text-align: center">0.988930</td> </tr> <tr> <td>17</td> <td style="text-align: center">0.993007</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.996491</td> </tr> <tr> <td>18</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">1.000000</td> </tr> <tr> <td>19</td> <td style="text-align: center">0.987654</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.993789</td> </tr> <tr> <td>20</td> <td style="text-align: center">0.866142</td> <td style="text-align: center">0.859375</td> <td style="text-align: center">0.862745</td> </tr> <tr> <td>21</td> <td style="text-align: center">0.818898</td> <td style="text-align: center">0.787879</td> <td style="text-align: center">0.803089</td> </tr> <tr> <td>22</td> <td style="text-align: center">0.995110</td> <td style="text-align: center">0.997549</td> <td style="text-align: center">0.996328</td> </tr> <tr> <td>23</td> <td style="text-align: center">0.989796</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.994872</td> </tr> <tr> <td>24</td> <td style="text-align: center">0.931315</td> <td style="text-align: center">1.000000</td> <td style="text-align: center">0.964436</td> </tr> </tbody> </table> <p>As it can be seen both architectures results in very similar f1 scores where some families are classified better than others.</p> <h3 id="best-model-on-bigger-dataset">Best Model on Bigger Dataset</h3> <p>Once we found the best model it was applied to the larger dataset. Naturally the results are not nearly as good as the MalImg dataset given that for that particular dataset there are only 25 families and there are fewer images. However, the model still yielded reasonable results. The 10-fold cross validation of the best model on Akash’s dataset yielded the following resutls: | Folds | Accuracy | MAE | |————–|:—-:|:——————:| | Fold 1 | 89% | 18.68 | | Fold 2 | 89% | 18.72 | | Fold 3 | 89% | 19.08 | | Fold 4 | 90% | 17.50 | | Fold 5 | 88% | 20.00 | | Fold 6 | 89% | 18.14 | | Fold 7 | 89% | 19.20 | | Fold 8 | 89% | 18.51 | | Fold 9 | 89% | 18.68 | | Fold 10 | 89% | 19.45 | | <strong>Average</strong> | <strong>89.47%</strong> | <strong>18.80</strong> | | <strong>Standard Deviation</strong> | <strong>0.447%</strong> | <strong>0.657</strong> |</p> <h2 id="references">References</h2> <ol> <li>Gibert, Daniel &amp; Mateu, Carles &amp; Planes, Jordi &amp; Vicens, Ramon. (2019). Using convolutional neural networks for classification of malware represented as images. Journal of Computer Virology and Hacking Techniques. 15. 10.1007/s11416-018-0323-0.</li> </ol> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2024 Guillem Ribes Espurz. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?07b8786bab9b4abe90d10e61f7d12ff7" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>